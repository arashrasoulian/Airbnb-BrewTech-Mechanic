<!DOCTYPE html>
<html>
<head>
  <title>AirBnB Brew-Tech_Mechanic</title>
  <style>
    .flat { border: 1px solid #ccc; margin: 20px; padding: 10px; }
    .booking-form { margin-top: 20px; }
    .user-greeting { margin-top: 20px; }
  </style>
</head>
<body>
  <div class="user-greeting">
    <% if user_signed_in? %>
      <p>Welcome, <%= current_user.email %></p>
      <%= link_to 'Log out', destroy_user_session_path, method: :delete %>
    <% else %>
      <%= link_to 'Sign up', new_user_registration_path %> or
      <%= link_to 'Log in', new_user_session_path %>
    <% end %>
  </div>

  <h1>Available Flats</h1>
  <% @flats.each do |flat| %>
    <div class="flat">
      <h2><%= flat.name %></h2>
      <p><%= flat.address %></p>
      <p>Price per night: <%= flat.price %> EUR</p>
      <%= image_tag flat.pictures ? flat.pictures : "/assets/images/no_image.jpeg" %>

    </div>
  <% end %>

  <div class="booking-form">
    <h2>Book a Flat</h2>
    <%= form_with model: @booking, local: true do |form| %>
      <div>
        <%= form.label :flat_id, "Choose a flat" %>
        <%= form.collection_select :flat_id, Flat.all, :id, :name, prompt: "Select..." %>
      </div>
      <div>
        <%= form.label :start_date, "Start date" %>
        <%= form.date_field :start_date %>
      </div>
      <div>
        <%= form.label :end_date, "End date" %>
        <%= form.date_field :end_date %>
      </div>
      <%= form.submit "Book" %>
    <% end %>
  </div>
</body>
</html>
